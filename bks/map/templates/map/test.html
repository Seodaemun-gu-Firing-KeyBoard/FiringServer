<!-- <!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>지도</title>
</head>

<body>
  <h1>네이버 지도API</h1>
  <h1>경로 및 소요시간 확인</h1>
  <form id="routeForm">
    <label for="startInput">출발지:</label>
    <input type="text" id="startInput" placeholder="출발지를 입력하세요"><br>
    <label for="endInput">도착지:</label>
    <input type="text" id="endInput" placeholder="도착지를 입력하세요"><br>
    <button type="submit">경로 확인</button>
  </form>
  <div id="map2" style="width: 500px; height: 400px;"></div>
  <div id="routeInfo"></div>

  <script type="text/javascript"
    src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=2lhimp3vcd&submodules=geocoder,directions"></script>
  <script>
    const routeform = document.getElementById('routeForm');
    const startInput = document.getElementById('startInput');
    const endInput = document.getElementById('endInput');

    const mapOptions = {
      center: new naver.maps.LatLng(37.580541, 126.922365),
      zoom: 17,
      mapTypeControl: true,
      zoomControl: true,
      scaleControl: true,
      mapDataControl: true,
    };

    var map2 = new naver.maps.Map('map2', mapOptions);

    routeform.addEventListener('submit', function (event) {
      event.preventDefault();
      const start = startInput.value;
      const end = endInput.value;
      if (start.trim() === '' || end.trim() === '') {
        alert('출발지와 도착지를 입력하세요.');
        return;
      }
      getRouteInfo(start, end);
    });

    function getRouteInfo(start, end) {
      naver.maps.Service.geocode({
        query: start
      }, function (startStatus, startResponse) {
        if (startStatus !== naver.maps.Service.Status.OK || startResponse.v2.meta.totalCount === 0) {
          alert('출발지 주소를 찾을 수 없습니다.');
          return;
        }

        naver.maps.Service.geocode({
          query: end
        }, function (endStatus, endResponse) {
          if (endStatus !== naver.maps.Service.Status.OK || endResponse.v2.meta.totalCount === 0) {
            alert('도착지 주소를 찾을 수 없습니다.');
            return;
          }

          const startResult = startResponse.v2.addresses[0];
          const endResult = endResponse.v2.addresses[0];
          const startCoord = new naver.maps.LatLng(startResult.y, startResult.x);
          const endCoord = new naver.maps.LatLng(endResult.y, endResult.x);

          naver.maps.Service.directions({
            start: startCoord,
            end: endCoord,
            options: {
              routeType: 'shortest'
            }
          }, function (status, response) {
            if (status === naver.maps.Service.Status.OK) {
              const routeInfo = response.result.routes[0];
              const duration = routeInfo.summary.duration.text;
              const distance = routeInfo.summary.distance.text;

              const routeText = `출발지: ${start}<br>도착지: ${end}<br>소요시간: ${duration}<br>거리: ${distance}`;
              const routeInfoDiv = document.getElementById('routeInfo');
              routeInfoDiv.innerHTML = routeText;

              const bounds = new naver.maps.LatLngBounds();
              bounds.extend(startCoord);
              bounds.extend(endCoord);
              map2.fitBounds(bounds);

              const path = routeInfo.path.map(coord => new naver.maps.LatLng(coord[1], coord[0]));
              const routePath = new naver.maps.Polyline({
                map: map2,
                path: path,
                strokeColor: '#f00',
                strokeWeight: 5,
              });
            } else {
              alert('경로를 찾을 수 없습니다.');
            }
          });
        });
      });
    }
  </script>
</body>

</html> -->

<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>네이버 지도API Directions 5 예제</title>
</head>

<body>
  <h1>네이버 지도API Directions 5</h1>
  <div id="map" style="width: 100%; height: 500px;"></div>

  <script type="text/javascript"
    src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=2lhimp3vcd&submodules=geocoder,directions"></script>
  <script>
    const start = [37.5666805, 126.9784147]; // 출발지 좌표
    const goal = [37.5662952, 126.9779451]; // 도착지 좌표
    const waypoint = [37.5661358, 126.9785408]; // 경유지 좌표
    const option = 'traoptimal'; // 탐색 옵션 (traoptimal, trafast, tracomfort, traavoidtoll, traavoidcaronly)

    const mapOptions = {
      center: new naver.maps.LatLng((start[0] + goal[0]) / 2, (start[1] + goal[1]) / 2), // 중심 좌표 설정
      zoom: 17,
      mapTypeControl: true,
      zoomControl: true,
      scaleControl: true,
      mapDataControl: true,
    };

    const map = new naver.maps.Map('map', mapOptions);

    function getOptimalRoute(start, goal, waypoint, option) {
      const client_id = '2lhimp3vcd';
      const client_secret = 'Yof4iAnAWenQ6Ell2CN4NptMPaMMKIK9zKHQj1EBy';
      const url = `https://naveropenapi.apigw.ntruss.com/map-direction/v1/driving?start=${start[0]},${start[1]}&goal=${goal[0]},${goal[1]}&waypoints=${waypoint[0]},${waypoint[1]}&option=${option}`;
      fetch(url, {
        headers: {
          'X-NCP-APIGW-API-KEY-ID': client_id,
          'X-NCP-APIGW-API-KEY': client_secret,
        }
      })
        .then(response => response.json())
        .then(data => {
          console.log(data); // 결과 확인
          // 여기에서 결과를 활용하여 지도에 경로를 표시할 수 있습니다.
        })
        .catch(error => {
          console.error('Error:', error);
        });
    }

    getOptimalRoute(start, goal, waypoint, option);
  </script>
</body>

</html>